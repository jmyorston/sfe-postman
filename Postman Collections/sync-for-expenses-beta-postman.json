{
	"info": {
		"_postman_id": "dc645638-25e5-4665-88a0-cac9b4cbab91",
		"name": "Sync For Expenses Beta",
		"schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
	},
	"item": [
		{
			"name": "Sync For Expenses Beta",
			"item": [
				{
					"name": "Company Auth",
					"item": [
						{
							"name": "Create Company",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var resp = JSON.parse(responseBody)\r",
											"\r",
											"// stores the accounting connection as a collection variable\r",
											"pm.collectionVariables.set(\"accountingConnectionId\", resp.dataConnections[0].id)\r",
											"pm.collectionVariables.set(\"companyId\", resp.id)\r",
											""
										],
										"type": "text/javascript",
										"id": "b01e08b5-f002-47db-9e5c-383ea5a28789"
									}
								}
							],
							"id": "87996bfc-31ea-4f2c-9df4-8051aaf278af",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\r\n  \"name\": \"{{$randomCompanyName}}\",\r\n  \"platformType\": \"qhyg\"\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": "{{baseUrl}}companies"
							},
							"response": []
						},
						{
							"name": "Create partnerExpense Connection",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var resp = JSON.parse(responseBody)\r",
											"\r",
											"// stores the accounting connection as a collection variable\r",
											"pm.collectionVariables.set(\"expenseConnectionId\", resp.id)"
										],
										"type": "text/javascript",
										"id": "ae1f64d9-6e61-499b-b0fb-36a35e0873b4"
									}
								}
							],
							"id": "0c451e64-5ed5-4b87-8541-d1c593363ed8",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{expenseUrl}}companies/:companyId/connections/partnerexpense",
									"host": [
										"{{expenseUrl}}companies"
									],
									"path": [
										":companyId",
										"connections",
										"partnerexpense"
									],
									"variable": [
										{
											"id": "676bb613-090f-4b38-897b-38ce3102b964",
											"key": "companyId",
											"value": "{{companyId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Connections",
							"id": "9f87d73b-bd8c-44f4-8317-41823cfa6e43",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}companies/:companyId",
									"host": [
										"{{baseUrl}}companies"
									],
									"path": [
										":companyId"
									],
									"variable": [
										{
											"key": "companyId",
											"value": "{{companyId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"id": "aedd3da2-5454-4b08-b4c7-cf01b61f587f"
				},
				{
					"name": "Config & Mapping",
					"item": [
						{
							"name": "Get Configuration",
							"id": "4715022b-aa2e-4d5f-a3a7-10fffc52c557",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{expenseUrl}}companies/:companyId/config",
									"host": [
										"{{expenseUrl}}companies"
									],
									"path": [
										":companyId",
										"config"
									],
									"variable": [
										{
											"id": "17a833ad-f53d-4a24-96fa-aa717dc64f60",
											"key": "companyId",
											"value": "{{companyId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Save Configuration",
							"id": "da6a2dcc-9b30-44d2-8da8-23c8369db41d",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\r\n    \"companyId\": \"{{companyId}}\",\r\n    \"accountingSoftwareCompanyName\": null,\r\n    \"enabled\": false,\r\n    \"configured\": true,\r\n    \"schedule\": {\r\n        \"selectedFrequency\": \"Daily\",\r\n        \"frequencyOptions\": [\r\n            \"Daily\"\r\n        ],\r\n        \"startDate\": \"0001-01-01T00:00:00\",\r\n        \"syncHourUtc\": 0,\r\n        \"timeZoneIanaId\": null\r\n    },\r\n    \"configuration\": {\r\n        \"syncAsBankFeeds\": {\r\n            \"enableSync\": false,\r\n            \"selectedBankAccountId\": null,\r\n            \"bankAccountOptions\": []\r\n        },\r\n        \"syncAsExpenses\": {\r\n            \"enableSync\": true,\r\n            \"supplier\": {\r\n                \"selectedSupplierId\": \"124\",\r\n                \"supplierOptions\": []\r\n            },\r\n            \"customer\": {\r\n                \"selectedCustomerId\": \"140\",\r\n                \"customerOptions\": []\r\n            },\r\n            \"selectedBankAccountId\": \"89\",\r\n            \"bankAccountOptions\": []\r\n        }\r\n    }\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{expenseUrl}}companies/:companyId/config",
									"host": [
										"{{expenseUrl}}companies"
									],
									"path": [
										":companyId",
										"config"
									],
									"variable": [
										{
											"id": "1f5a6454-864e-4d86-9dac-550788c40420",
											"key": "companyId",
											"value": "{{companyId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get expense mapping options",
							"id": "3c428e17-ab34-4bdf-a0c1-ee4f6f064166",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{expenseUrl}}companies/:companyId/mappingoptions",
									"host": [
										"{{expenseUrl}}companies"
									],
									"path": [
										":companyId",
										"mappingoptions"
									],
									"variable": [
										{
											"id": "52e3d519-7b4a-4508-8a7f-21e14d10907d",
											"key": "companyId",
											"value": "{{companyId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET Suppliers",
							"id": "8f4156ce-9cc7-417a-9c13-1e397ea77c5e",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}companies/:companyId/data/suppliers",
									"host": [
										"{{baseUrl}}companies"
									],
									"path": [
										":companyId",
										"data",
										"suppliers"
									],
									"variable": [
										{
											"key": "companyId",
											"value": null
										}
									]
								}
							},
							"response": []
						}
					],
					"id": "d02ccc2d-400f-4462-a24f-a21d756c25e4"
				},
				{
					"name": "Datasets",
					"item": [
						{
							"name": "Create Expense Dataset",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "db0e5006-e7a3-45d9-a51d-86ed77c2a5c6",
										"exec": [
											"var resp = JSON.parse(responseBody)\r",
											"\r",
											"pm.collectionVariables.set(\"datasetId\", resp.datasetId)"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "541f8149-ae2b-4650-b158-256e308ab8ab",
										"exec": [
											"let uuid = require('uuid');\r",
											"pm.collectionVariables.set(\"transactionId1\", uuid.v4());\r",
											"pm.collectionVariables.set(\"transactionId2\", uuid.v4());"
										],
										"type": "text/javascript"
									}
								}
							],
							"id": "bd019ef9-9e7f-4a8f-a5b2-6564b273a8b0",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": " {\r\n   \"items\": [\r\n     {\r\n       \"id\": \"{{transactionId1}}\",\r\n       \"type\": \"Payment\",\r\n       \"issueDate\": \"2023-01-02\",\r\n       \"dateApproved\": \"2023-01-02\",\r\n       \"currency\": \"GBP\",\r\n       \"lines\": [\r\n         {\r\n           \"netAmount\": -23.75,\r\n           \"taxAmount\": -4.75,\r\n           \"taxRateRef\": { \"id\": \"23_Bills\" },\r\n           \"accountRef\": { \"id\": \"88\" },\r\n           \"trackingRefs\": [\r\n             //{ \"id\": \"2f2498b9-f8cc-4985-b6ee-58ca2b32e3e6\" }\r\n           ]\r\n         }\r\n       ]\r\n     }\r\n   ]\r\n }",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{expenseUrl}}companies/:companyId/data/expense-transactions",
									"host": [
										"{{expenseUrl}}companies"
									],
									"path": [
										":companyId",
										"data",
										"expense-transactions"
									],
									"variable": [
										{
											"id": "fc465499-52b9-4053-b150-377c187a062c",
											"key": "companyId",
											"value": "{{companyId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"id": "6547dabf-f95f-4de0-adbf-e2ac60728a13"
				},
				{
					"name": "Syncing Expenses",
					"item": [
						{
							"name": "Initiate Sync",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var resp = JSON.parse(responseBody)\r",
											"\r",
											"pm.collectionVariables.set(\"syncId\", resp.syncId)"
										],
										"type": "text/javascript",
										"id": "c06ff967-f900-4eb4-ba55-86725a60be6b"
									}
								}
							],
							"id": "e080e0e8-f34f-413a-be4f-504e7172fc5f",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\r\n   \"datasetIds\": [\r\n     \"{{datasetId}}\"\r\n   ]\r\n }",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{expenseUrl}}companies/:companyId/syncs",
									"host": [
										"{{expenseUrl}}companies"
									],
									"path": [
										":companyId",
										"syncs"
									],
									"variable": [
										{
											"id": "64ef30c7-cbf8-49cd-9625-2c295265064f",
											"key": "companyId",
											"value": "{{companyId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Sync Status",
							"id": "f86ff14b-9916-45ed-b265-fa919638d60f",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{expenseUrl}}companies/:companyId/syncs/:syncId/status",
									"host": [
										"{{expenseUrl}}companies"
									],
									"path": [
										":companyId",
										"syncs",
										":syncId",
										"status"
									],
									"variable": [
										{
											"id": "8a402e21-6ab5-4652-a53d-31bae6864415",
											"key": "companyId",
											"value": "{{companyId}}"
										},
										{
											"id": "9ef1a5f8-049b-4655-bbac-ae9ca5d3d523",
											"key": "syncId",
											"value": "{{syncId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Sync Statuses",
							"id": "9c72f384-ead0-4f86-8ab8-602902888cef",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{expenseUrl}}companies/:companyId/syncs/list/status",
									"host": [
										"{{expenseUrl}}companies"
									],
									"path": [
										":companyId",
										"syncs",
										"list",
										"status"
									],
									"variable": [
										{
											"id": "07fb7ffb-850b-44c2-b2e0-dc3f9b351a97",
											"key": "companyId",
											"value": "{{companyId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET Transaction Status",
							"id": "0ecc8107-a890-450f-b8a0-a6c48015c309",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{expenseUrl}}companies/:companyId/syncs/:syncId/transactions",
									"host": [
										"{{expenseUrl}}companies"
									],
									"path": [
										":companyId",
										"syncs",
										":syncId",
										"transactions"
									],
									"variable": [
										{
											"id": "8cb09263-c334-454c-8d0e-9bc45ced4183",
											"key": "companyId",
											"value": "{{companyId}}"
										},
										{
											"id": "36546bad-73f4-41bd-9ff8-184bc53f96f7",
											"key": "syncId",
											"value": "{{syncId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"id": "9783943e-5d17-45ae-b992-b9f1c2cb2476"
				},
				{
					"name": "Upload Receipt",
					"id": "6d13e7b2-77d3-4763-9699-4dd43f3d6cf3",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "multi-part",
									"type": "file",
									"src": "/C:/Users/JamesYorston/Downloads/cot_daily_syncs (1).png"
								}
							]
						},
						"url": {
							"raw": "{{expenseUrl}}companies/:companyId/syncs/:syncId/transactions/:transactionId/attachments",
							"host": [
								"{{expenseUrl}}companies"
							],
							"path": [
								":companyId",
								"syncs",
								":syncId",
								"transactions",
								":transactionId",
								"attachments"
							],
							"variable": [
								{
									"key": "companyId",
									"value": "{{companyId}}"
								},
								{
									"key": "syncId",
									"value": "{{syncId}}"
								},
								{
									"key": "transactionId",
									"value": "{{transactionId1}}"
								}
							]
						}
					},
					"response": []
				}
			],
			"id": "95fbcff6-4680-40b9-b003-1e721ddeedcf",
			"auth": {
				"type": "apikey",
				"apikey": {
					"value": "{{codat_api_key_base_64}}",
					"key": "Authorization"
				}
			},
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						],
						"id": "24988e62-caeb-4463-90c4-0f8db12c3804"
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						],
						"id": "70734a3f-713e-4437-b07a-c782ee135f85"
					}
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				],
				"id": "f6cd42b3-a0d5-4993-aee4-a853136007e1"
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				],
				"id": "c98b4282-9b97-42cf-97ce-cfa562b4363d"
			}
		}
	],
	"variable": [
		{
			"id": "2d5ff343-89cc-4d50-bf7d-35a456759003",
			"key": "companyId",
			"value": "00000000-0000-0000-0000-000000000000"
		},
		{
			"id": "85660e27-2a15-412f-8ca8-812f0eda53d8",
			"key": "orderId",
			"value": ""
		},
		{
			"id": "2a0d8170-542e-454a-b6d0-97edb0acc6f3",
			"key": "accountingConnectionId",
			"value": ""
		},
		{
			"id": "64435406-3554-4295-822a-8f0f503993c1",
			"key": "codat_api_key_base_64",
			"value": "Basic T2lMamRidGRwb0ROR2M3ZE1RZ2lhYWFRNElKbW1Gb045b2VaSFNWNg==",
			"type": "string"
		},
		{
			"id": "a1a5ac0e-cf5d-4c30-ba1d-3f65ca5a7c44",
			"key": "commerceKey",
			"value": "lqai",
			"type": "string"
		},
		{
			"id": "13947ffd-531a-4e80-bfd6-f8c38791beb9",
			"key": "accountingKey",
			"value": "gbol",
			"type": "string"
		},
		{
			"id": "6470fa13-b9af-4dc1-8973-7b0301076ac1",
			"key": "merchantName",
			"value": "SME Name or ID",
			"type": "string"
		},
		{
			"id": "5c735edf-a8de-434f-897b-cd0ce9208e81",
			"key": "platformKey",
			"value": "mqjo",
			"type": "string"
		},
		{
			"id": "226d7f71-46c4-46a3-ac1f-a9e9d858bcb9",
			"key": "connectionId",
			"value": "",
			"type": "string"
		},
		{
			"id": "f398863f-5943-433f-95ff-221b9ed289f3",
			"key": "expenseUrl",
			"value": "https://expensesync-integration.codat.io/",
			"type": "string"
		},
		{
			"id": "88918b98-977c-48de-a8e6-8a137eda1385",
			"key": "baseUrl",
			"value": "https://api-integration.codat.io/",
			"type": "string"
		},
		{
			"id": "d25e7d00-71cd-451f-80b6-98d632c7ffb1",
			"key": "expenseConnectionId",
			"value": ""
		},
		{
			"id": "ffdf2081-1690-47b3-b47c-09e4226c4f5c",
			"key": "datasetId",
			"value": "",
			"type": "string"
		},
		{
			"id": "d0aea4ff-c67e-4cca-9ac4-5351a650ad35",
			"key": "syncId",
			"value": ""
		},
		{
			"id": "9824e74e-5aec-44de-a9e3-efe781750953",
			"key": "transactionId",
			"value": ""
		},
		{
			"id": "4428e6d7-5dfc-44ab-ba80-47ac2a31185f",
			"key": "transactionId1",
			"value": ""
		},
		{
			"id": "f4a850d5-3e25-47f8-a9f4-3118c00ee94f",
			"key": "transactionId2",
			"value": ""
		}
	]
}